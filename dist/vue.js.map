{"version":3,"file":"vue.js","sources":["../src/until/until.js","../src/global-api/index.js","../src/compiler/generate.js","../src/compiler/parse.js","../src/compiler/index.js","../src/vdom/patch.js","../src/observer/dep.js","../src/observer/schedular.js","../src/observer/watcher.js","../src/lifecycle.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/index.js"],"sourcesContent":["let callbacks = []\r\n\r\nfunction flushCallbacks() {\r\n    for (let i = 0; i < callbacks.length; i++) {\r\n        let callback = callbacks[i];\r\n        callback()\r\n    }\r\n    waiting = false\r\n}\r\n//批处理  第一次开定时器  后续只更新列表  之后执行清空逻辑\r\n\r\n//第一次cb是渲染watcher  更新操作  (渲染watcher执行的过程肯定是同步的)\r\n//第二次的cb是用户传入的回调\r\nlet waiting = false;\r\nexport function nextTick(cb) {\r\n    callbacks.push(cb)//目前默认的cb  是渲染逻辑  用户的逻辑放到渲染逻辑之后即可\r\n\r\n    if (!waiting) {\r\n        waiting = true\r\n        //vue2 做兼容性处理先判断是否支持Promise，如果不支持就采用MutationObserver()，然后是seImmediate（ie专用），最后是setTimeout，依次判断。\r\n\r\n\r\n        Promise.resolve().then(flushCallbacks)//多次调用nextTick 只会开启一个promise\r\n    }\r\n\r\n}\r\n\r\n\r\n//nextTick肯定有异步功能\r\n\r\nexport const isObject = (val) => typeof val == 'object' && val != null\r\n\r\nexport const LIFECYCLE_HOOKS = [\r\n    'beforeCreate',\r\n    'created',\r\n    'beforeMount',\r\n    'mounted'\r\n]\r\nconst strats = {};\r\nfunction mergeHook(parentVal, childVal) {\r\n    console.log(parentVal, childVal)\r\n    if (childVal) {//如果没有儿子\r\n        if (parentVal) {\r\n            return parentVal.concat(childVal)\r\n        } else {//如果儿子有父亲没有\r\n            return [childVal]\r\n        }\r\n    } else {\r\n        return parentVal\r\n    }\r\n\r\n}\r\nLIFECYCLE_HOOKS.forEach(hook => {\r\n    strats[hook] = mergeHook\r\n})\r\n\r\nstrats.components = function (parentVal, childVal) {\r\n    const res = Object.create(parentVal);\r\n    if (childVal) {\r\n        for (let key in childVal) {\r\n            res[key] = childVal[key];\r\n        }\r\n    }\r\n    return res\r\n}\r\n//生命周期合并\r\nexport function mergeOptions(parent, child) {\r\n    //console.log(parent, child)\r\n    const options = {}\r\n    //{a:1}  {a:2} =>  合并后  {a:2}\r\n    //{a:1}       =>  合并后{a:1}\r\n    //自定义策略\r\n    //1.如果父亲有，儿子也有 应该用儿子替换父亲\r\n    //2.如果父亲有值  儿子没有  用父亲的 \r\n\r\n\r\n    for (let key in parent) {\r\n        mergeField(key)\r\n    }\r\n    for (let key in child) {\r\n        if (parent.hasOwnProperty(key)) {\r\n            mergeField(key)\r\n\r\n        }\r\n    }\r\n    function mergeField(key) {\r\n        //策略模式\r\n        if (strats[key]) {\r\n            return options[key] = strats[key](parent[key], child[key])\r\n        }\r\n        if (isObject(parent[key]) && isObject(child[key])) {\r\n            options[key] = { ...parent[key], ...child[key] }\r\n        } else {\r\n            if (child[key]) {//如果儿子有值   以儿子的值为准\r\n                options[key] = child[key];\r\n            } else {\r\n                options[key] = parent[key]\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    return options\r\n}\r\n\r\n\r\n\r\n//对标签进行过滤   区分哪些是自定义标签\r\nfunction makeUP(str) {\r\n    const map = {\r\n        \r\n    }\r\n    str.split(',').forEach(tagName => {\r\n        map[tagName]=true\r\n    })\r\n    return(tag)=>map[tag]||false\r\n}\r\n \r\n export const isReservedTag = makeUP('a,p,div,ul,li,text,span,input,button')\r\n\r\n//console.log(isReservedTag('my-button'))\r\n","import { mergeOptions } from \"../until/until\"\r\n\r\nexport function initGlobalAPI(Vue) {\r\n    Vue.options={}//用来存储全局的配置   例如   页面调取了两次mixin  就应该将第一的的mixi中的内容先存储 然后将第二个跟第一个做合并\r\n   //filter directive component\r\n    Vue.mixin = function (mixin) {\r\n\r\n        //mergeOptions\r\n        this.options = mergeOptions(this.options, mixin)\r\n        //console.log(this.options)\r\n        return this;\r\n    }\r\n\r\n\r\n    Vue.options_base = Vue;//Vue 的构造函数\r\n    Vue.options.components={}//用来存放组件的定义\r\n    Vue.component = function (id,definition) {\r\n        definition.name = definition.name || id;\r\n        definition = this.options_base.extend(definition)//通过对象产生一个构造函数\r\n\r\n        this.options.components[id] = definition;\r\n        console.log(this.options)\r\n    }\r\n    let cid = 0;\r\n    Vue.extend = function (options) {//子组件初始化时会 new VueComponent()\r\n        //new VueComponent()\r\n        const Super = this;\r\n        const Sub = function VueComponent (options) {\r\n            this._init(options)\r\n        }\r\n        Sub.cid = cid++;\r\n        Sub.prototype = Object.create(Super.prototype);//都是通过Vue继承来的\r\n        Sub.prototype.constructor = Sub;\r\n        Sub.component = Super.extend;\r\n        //每次声明一个组件 都会把父级的定义放到自己的身上\r\n        Sub.options = mergeOptions(\r\n            Super.options,\r\n            options)\r\n        return Sub//这个构造函数是由对象产生而来的\r\n    }\r\n    //Sub.component()\r\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //{{}}\r\n\r\nfunction genProps(attrs){\r\n    let str=''\r\n    for(let i=0; i<attrs.length; i++){\r\n        let attr =attrs[i] //name value\r\n        if(attr.name==='style'){\r\n            let obj={}\r\n            attr.value.split(';').forEach(item => {\r\n             let [key,value]  = item.split(':');\r\n             obj[key]=value\r\n            });\r\n            attr.value=obj;//{style:{color:blue}}\r\n        }\r\n        str +=`${attr.name}:${JSON.stringify(attr.value)},`//{a:'aaa',a:1,b:2}\r\n    }\r\n    return` {${str.slice(0,-1)}}`\r\n}\r\n\r\n\r\nfunction genChildren(AST){\r\n    const children = AST.children;\r\n    if(children){\r\n        return children.map(child=>gen(child)).join(',')\r\n    }\r\n}\r\n\r\nfunction gen(node){//区分是元素还是文本\r\n    console.log(node)\r\n\r\n    if(node.type==1){\r\n        return generate(node)\r\n    }else{//文本逻辑不能用_c处理\r\n            //1.有{{}}  普通文本   混合文本 {{name}}  aaa {{age}} bbb\r\n        let text=node.text;\r\n        if(defaultTagRE.test(text)){//_v(_s(name)+_v('aa')\r\n            //说明是带有{{}}\r\n            let tokens =[];\r\n            let match;\r\n            let index=0;\r\n            let lastIndex=defaultTagRE.lastIndex =0;\r\n            while (match = defaultTagRE.exec(text)) {//{{name}}  aaa {{age}} bbb\r\n                index=match.index;\r\n                console.log(match)\r\n                if(index > lastIndex){\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex,index)));\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`);\r\n                lastIndex=index + match[0].length;\r\n            }\r\n            if(lastIndex < text.length){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n\r\n            }\r\n            return `_v(${tokens.join('+')})`\r\n\r\n        }else{\r\n            return `_v(${JSON.stringify(text)})`\r\n        }\r\n    }\r\n}\r\n\r\nexport function generate(AST){//转换成render代码\r\n    console.log(AST)\r\n\r\n    let children = genChildren(AST)\r\n\r\n    let code =`_c('${AST.tag}',${\r\n        AST.attrs.length? genProps(AST.attrs):'undefined'\r\n    }${\r\n        children?(',' + children) : ''\r\n    })`\r\n    console.log(code)\r\n\r\n    return code;\r\n    //进行语法转化  将html代码转化js代码  核心 字符串拼接\r\n}\r\n\r\n\r\n/* <div id=\"app\">\r\n    <div style=\"color:blue\">\r\n            <span>{{name}}</span>\r\n    </div>\r\n</div> \r\n变成render函数  reder函数执行后的结果是个虚拟dom\r\n\r\nrender(){ \r\n    return _c('div',{id:'app'}，\r\n    _c(\r\n        'div',\r\n        {style:{color:\"blue\"}},\r\n        _c(\r\n            'span',\r\n            {}\r\n            _s(_v\"name\")\r\n        )\r\n    )\r\n}\r\n\r\n*/","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //匹配类标签名的  里面的\\\\相当于转译 变成一个\\\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //aa:aa\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); //可以匹配到标签名\r\n\r\n//console.log(\"<div:aa>\".match(startTagOpen));\r\n\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //标签结束名字\r\n//console.log(\"</div:xxx>\".match(endTag));\r\n//style=\"xxx\"  style='xxx'  style=xxx\r\nconst attribute =\r\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\n//console.log(`a='2'`.match(attribute));\r\n\r\nconst startTagClose = /^\\s*(\\/?)>/;\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //{{}}\r\n\r\n\r\n  /* <div id=\"app\">\r\n    <div style=\"color:blue ;\">\r\n      <span>{{name}}</span>\r\n    </div>\r\n</div>\r\n  */\r\n\r\n//AST语法树  描述dom结构\r\n// {\r\n//     tag:'div',//根节点\r\n//     type:1, 元素是1  文本是3  约定俗成\r\n//     attrs:[{style:\"color:red\"}]\r\n//     children:[\r\n//         {\r\n//             tag:'span',\r\n//             type:1,\r\n//             attrs:[],//属性\r\n//             children,\r\n//             parent:\r\n//         }\r\n//     ],\r\n//     parent:null\r\n// }\r\n\r\n /* <div id=\"app\">\r\n        <div style=\"color:blue ;\">\r\n             <span>{{name}}</span>\r\n        </div>\r\n    </div>\r\n  */\r\n\r\nexport function parseHTML(html) {\r\n    function createASTElement(tag,attrs){//vue3中支持多个根元素(外层加了个空元素)，vue2中只有一个根节点\r\n        return{\r\n          tag,\r\n          type:1,\r\n          children:[],\r\n          attrs,\r\n          parent:null\r\n        }\r\n      }\r\n      \r\n      let root =null;\r\n      let currentParent;\r\n      let stack=[];\r\n\r\n\r\n  //根据开始标签  结束标签  文本内容  生成一个AST语法树\r\n    function start(tagName,attrs){\r\n      //console.log('start------',tagName)\r\n      let element =createASTElement(tagName,attrs)\r\n      if(!root){//如果没有根  说明就是第一个元素\r\n          root = element\r\n      }\r\n      currentParent = element;//div->span->a   \r\n      stack.push(element)\r\n\r\n    }\r\n\r\n    function end(tagName){\r\n      //console.log('end------',tagName)\r\n      let element=stack.pop()\r\n      currentParent=stack[stack.length-1]\r\n      if(currentParent){\r\n        element.parent=currentParent;\r\n        currentParent.children.push(element)\r\n      }\r\n    }\r\n    function chars(text){\r\n      //console.log('chars------',text)\r\n\r\n      //文本可能为空   源码里会将其变成一个空格   此处是移除所有空格  \r\n      text = text.replace(/\\s/g,'');\r\n      if(text){\r\n        currentParent.children.push({\r\n          type:3,\r\n          text\r\n        })\r\n      }\r\n\r\n    }\r\n\r\n    //截取\r\n    function advance(n){\r\n        html = html.substring(n)\r\n    }\r\n\r\n    function parseStartTag(){\r\n    const start = html.match(startTagOpen)\r\n    if(start){\r\n        let match ={\r\n            tagName:start[1],\r\n            attrs:[],\r\n        }\r\n        advance(start[0].length);//获取元素\r\n       console.log(html,match)\r\n       //查找属性\r\n       let end,attr;\r\n       //不是开头标签结尾 就一直解析\r\n       while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\r\n            console.log(attr)\r\n            advance(attr[0].length)\r\n            match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\r\n       }\r\n       if(end){\r\n        advance(end[0].length);\r\n        return match\r\n       }\r\n    }\r\n    }\r\n  //标签是以<>开头\r\n\r\n  while (html) {\r\n    let textEnd = html.indexOf('<');//判断 如果<的索引是0,就说明是一个元素 \r\n    if(textEnd == 0 ){\r\n       let startTagMatch = parseStartTag();\r\n       if(startTagMatch){//开始标签\r\n        // console.log(startTagMatch)\r\n        // console.log('开始',startTagMatch.tagName)\r\n        start(startTagMatch.tagName,startTagMatch.attrs)\r\n        continue;\r\n       }\r\n\r\n       //结束标签\r\n       let endTagMatch = html.match(endTag)\r\n       if(endTagMatch){\r\n        advance(endTagMatch[0].length)\r\n      //console.log('结尾',endTagMatch[1])\r\n       end(endTagMatch[1])\r\n\r\n        continue;\r\n       }\r\n       \r\n    }\r\n     /* \r\n\r\n        <div style=\"color:blue ;\">\r\n             <span>{{name}}</span>\r\n        </div>\r\n    </div>\r\n  */\r\n    let text;\r\n    if(textEnd > 0){//开始解析文本\r\n      text =html.substring(0,textEnd)\r\n\r\n    }\r\n    if(text){\r\n      advance(text.length);\r\n      //console.log('文本',text)\r\n      chars(text)\r\n\r\n      //console.log(text);\r\n\r\n    }\r\n\r\n  }\r\n  return root;\r\n}\r\n","import { generate } from \"./generate\";\r\nimport { parseHTML } from \"./parse\";\r\n\r\nexport function compileToFunctions(template) {\r\n  //1.先将模板变成AST抽象树  解析模板\r\n  let AST = parseHTML(template); //解析模板  原理是 每解析一块儿  就删掉一块 长度为0时  就意味着都解析完了\r\n  console.log(template);\r\n  // console.log(root);\r\n\r\n  //root  代码生成\r\n\r\n  let code = generate(AST);\r\n\r\n  let render = `with(this){return ${code}}`;\r\n  console.log(render)\r\n  let fn = new Function(render);\r\n  console.log(fn)\r\n  return fn\r\n\r\n\r\n}\r\n","\r\n\r\nexport function patch(oldVnode, Vnode) {\r\n    //oldVnode是一个真实额元素 (首次渲染)\r\n    //console.log(oldVnode, newVnode)\r\n    const isRealElement = oldVnode.nodeType\r\n\r\n    if (isRealElement) {\r\n        //初次渲染\r\n        const oldElm = oldVnode;//拿到 id=\"app\"\r\n        const parentElm = oldElm.parentNode;//拿到父元素 body\r\n\r\n        let el = createElm(Vnode)  //根据虚拟节点 创建出真实节点\r\n        parentElm.insertBefore(el, oldElm.nextSibling)//将创建的节点插到原有的节点的下一个\r\n        parentElm.removeChild(oldElm);\r\n\r\n        return el//vm.$el\r\n    } else {\r\n        //diff算法\r\n    }\r\n}\r\n\r\nfunction createComponent(vnode) {\r\n    let i = vnode.data;\r\n    if ((i = i.hook) && (i = i.init)) {\r\n        i(vnode);//调用组件的初始化方法\r\n    }\r\n    return false\r\n}\r\n\r\n\r\n//根据虚拟节点 创建出真实节点\r\nfunction createElm(vnode) {\r\n    let { vm, tag, data, key, children, text } = vnode\r\n    if (typeof tag === 'string') {//也可能是个组件 先不考虑   两种可能\r\n\r\n        //可能是组件，如果是组件就直接根据组件创建出组件对应的真实节点\r\n        if (createComponent(vnode)) {\r\n            //如果返回true说明这个虚拟节点是组件\r\n\r\n            //如果是组件  就将组件渲染后的真实元素给我\r\n            return\r\n        }\r\n\r\n\r\n\r\n\r\n        vnode.el = document.createElement(tag);//用vue的指令时，可以用过vnode拿到真实的dom  虚拟节点配合真实dom\r\n        //更新dom上的属性\r\n        updateProperties(vnode);\r\n\r\n        //有可能有儿子\r\n        children.forEach(child => {//可能有文本  可能有元素\r\n            //根据子节点 创建元素\r\n            vnode.el.appendChild(createElm(child))//递归创建\r\n\r\n        })\r\n    } else {//文本情况\r\n        vnode.el = document.createTextNode(text)\r\n\r\n    }\r\n\r\n    return vnode.el\r\n}\r\n\r\nfunction updateProperties(vnode) {\r\n    let newProps = vnode.data || {};//属性\r\n    let el = vnode.el//dom元素\r\n\r\n    for (let key in newProps) {\r\n        if (key == 'style') {\r\n            for (let styleName in newProps.style) {\r\n                el.style[styleName] = newProps.style[styleName]\r\n            }\r\n        } else if (key == 'class') {\r\n            el.className = newProps.class\r\n        } else {\r\n            el.setAttribute(key, newProps[key])\r\n\r\n        }\r\n    }\r\n}","//我们可以把当前watcher 放到一个全局变量上\r\nlet id = 0;//为了保持dep的唯一性\r\nclass Dep {\r\n    constructor() {\r\n        this.id = id++;\r\n        this.subs = [];//属性要记住watcher\r\n\r\n    }\r\n    depend() {\r\n        //让watcher记住dep\r\n        //获取watcher\r\n        Dep.target.addDep(this)//这里的this指的是Dep  name=>watcher  \r\n    }\r\n    //让dep记住watcher  \r\n    addSub(watcher) {//存储watcher\r\n        this.subs.push(watcher)\r\n    }\r\n    notify() {\r\n        this.subs.forEach(watcher => watcher.update())\r\n    }\r\n}\r\nDep.target = null;//类的静态属性\r\n\r\n//收集依赖\r\nexport function pushTarget(watcher) {\r\n    Dep.watcher = watcher\r\n}\r\nexport function popTarget() {\r\n    Dep.target = null;\r\n}\r\n\r\n\r\n\r\nexport default Dep;","import { nextTick } from \"../until/until\";\r\n\r\nlet has = {};\r\nlet queue = [];\r\n\r\n\r\nfunction flushSchedularQueue() {\r\n    for (let i = 0; i < queue.length; i++) {\r\n        let watcher = queue[i]\r\n        watcher.run()\r\n    }\r\n    queue = []\r\n    has = {}\r\n    pending = false\r\n}\r\n\r\n\r\n//vue更新操作是异步操作\r\n//多次调用queueWatcher 如果watcher不是同一个\r\nlet pending = false\r\nexport function queueWatcher(watcher) {//调度更新几次\r\n    //更新时将watcher去重\r\n    let id = watcher.id;\r\n    if (has[id] == null) {\r\n        queue.push(watcher);\r\n        has[id] = true;\r\n        console.log(queue);\r\n        //让queue清空\r\n        if (!pending) {\r\n            pending = true\r\n            nextTick(flushSchedularQueue);\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n}","import { popTarget, pushTarget } from \"./dep\";\r\nimport { queueWatcher } from \"./schedular\";\r\n\r\n//每个组件间有多个watcher  所以需要加一个唯一标识  \r\nlet id = 0;\r\nclass Watcher {\r\n    constructor(vm, exprOrFn, cb, options) {\r\n        this.vm = vm;\r\n        this.cb = cb;\r\n        this.options = options;\r\n        this.id = id++\r\n        this.getter = exprOrFn\r\n        this.drps = [];\r\n        this.depsId = new Set();//去重  \r\n\r\n        this.get();//调用传入的函数 调用了render方法  此时会对模板中的数据进行取值\r\n    }\r\n    get() {//这个方法中会对属性进行取值操作\r\n        pushTarget(this)// 给Dep.target赋了值 =watcher\r\n        this.getter()//会取值  执行了observer中index.js中的54行 \r\n        popTarget();//Dep.target = null;\r\n    }\r\n    addDep(dep) {\r\n        let id = dep.id;\r\n        if (!this.depsId.has(id)) {//dep是非重复的\r\n            this.depsId.add(id)\r\n            this.deps.push(dep)\r\n            dep.addSub(this)\r\n        }\r\n    }\r\n    run() {\r\n        this.get();\r\n    }\r\n\r\n    update() {//如果多次更改，我希望合并一次  (可以看成防抖)\r\n       // this.get()//不停地重新渲染\r\n        console.log(this)//此处this指向watcher\r\n        queueWatcher(this)//此时可能有重复的\r\n    }\r\n    //当属性取值时  需要记住这个watcher，稍后变化了  去执行自己记住的watcher即可     依赖收集\r\n}\r\n\r\n\r\nexport default Watcher;","import { patch } from \"./vdom/patch\";\r\nimport Watcher from \"./observer/watcher\"\r\n//渲染成真实DOM的\r\nexport function lifecycleMixin(Vue) {\r\n    Vue.prototype._update = function (vnode) {\r\n        // console.log('update', vnode);\r\n        //将虚拟节点转换成真实dom\r\n        const vm = this;\r\n\r\n        console.log(vm.$options.el,vnode)\r\n        //首次渲染 需要用虚拟节点 来更新真实的dom元素\r\n        //初始化渲染的时候 会创建一个新节点 并且将老节点删掉\r\n\r\n        //第一次渲染完毕后 拿到新的节点 下次再次渲染时替换上次渲染的结果\r\n        vm.$el = patch(vm.$el, vnode);\r\n    }\r\n}\r\n\r\n//调用生命周期钩子函数  发布模式\r\nexport function callHook(vm,hook) {\r\n    const handlers = vm.$options[hook]\r\n    if (handlers) {\r\n        handlers.forEach(handler => {\r\n            handler.call(vm)\r\n        });\r\n    }\r\n}\r\n\r\n\r\nexport function mountComponent(vm, el) {\r\n    console.log(vm, el)\r\n\r\n    //Vue渲染机制\r\n    //Vue默认通过watcher来进行渲染的 = 渲染watcher(每一个组件都有一个渲染watcher)\r\n\r\n    let updateComponent = () => {\r\n        //调用runder方法\r\n        vm._update(vm._render());//返回的是虚拟节点   是一个对象 vm._update是将虚拟节点转化为真实节点\r\n    }\r\n    //让实例的某某方法执行  四个参数   后面加true是为了表明 该watcher是一个渲染watcher\r\n    new Watcher(vm, updateComponent, () => { }, true) //这句话就是相当于让 updateComponent 执行 updateComponent();\r\n\r\n\r\n}","//首先  我需要拿到原来数组原型上的方法  天生自带的方法\r\nlet oldArrayProtoMethods = Array.prototype;\r\n\r\n//不能直接改写数组原有方法  不可靠  因为只有在vue data中定义的数组才需要改写\r\n\r\n//创建一个元素  让他指向原型   继承关系\r\nexport let arrayMethods = Object.create(Array.prototype);\r\n\r\n//因为他指向数组原型链 所以 就可以拿到原型链上的方法\r\n//arrayMethods.push===arrayMethods._proto_.push\r\n\r\n//对数组方法进行重写  一般对改变原数组的操作进行重写\r\n\r\nlet methods = [\r\n    \"push\", \r\n    \"pop\", \r\n    \"shift\", \r\n    \"unshift\", \r\n    \"splice\", \r\n    \"reverse\", \r\n    \"sort\"\r\n];\r\n//如果用户调用arrayMethods.push方法，会调取我重写后的 也就是下面这一坨\r\n\r\nmethods.forEach((methods) => {//AOP切片编程   把原有的逻辑 割一刀 插入自己的逻辑\r\n  arrayMethods[methods] = function (...args) {//重写数组方法\r\n        //做些自己的事儿 \r\n    console.log('数组变化')\r\n    let result = oldArrayProtoMethods[methods].call(this,...args);//这里的this指向arrayMethods\r\n    \r\n    \r\n    //有可能用户后增加的数据是对象格式，也需要进项拦截\r\n    //做个判断  只对数组增加的方法进行判断\r\n    let inserted;\r\n    let ob=this.__ob__;\r\n    switch (methods) {\r\n        case 'push':\r\n        case 'unshift':\r\n            inserted=args;\r\n            break;\r\n            case 'splice'://splice(0,1,xxxx) \r\n            //因为splice方法第三个才是新增的   \r\n            inserted=args.slice(2);\r\n        default:\r\n            break;\r\n    }\r\n\r\n   if(inserted){//如果有值 都需要调observeArray()  这里的this指向调用者 this.__ob__.observeArray(inserted) \r\n       ob.observeArray(inserted)\r\n      \r\n      }\r\n      ob.dep.notify()\r\n    return result\r\n  };\r\n});\r\n","import { arrayMethods } from \"./array\";\r\nimport Dep from \"./dep\";\r\n//对数组和对象进行拦截\r\nclass Observer {\r\n  constructor(value) {\r\n    //需要对val属性重新定义\r\n\r\n    //value可能是对象 可能是数组，分类处理    数组不用defineProperty拦截\r\n\r\n    //增加一个自定义属性\r\n    //value.__ob__=this;\r\n\r\n    this.dep = new Dep();//给数组本身和对象本身增加一个dep属性\r\n    Object.defineProperty(value, \"__ob__\", {\r\n      value: this,\r\n      enumerable: false, //不能被枚举 表示  不能被循环\r\n      configurable: false, //不能删除此属性\r\n    });\r\n\r\n    if (Array.isArray(value)) {\r\n      //数组不用defineProperty拦截  性能不好\r\n      //操作数组方法  push  shift  sort   我需要重写这些方法(一共7个)  增加更新逻辑\r\n      //当是数组时  改写方法为自己重写后的方法\r\n      Object.setPrototypeOf(value, arrayMethods); // 等价于value._proto_ = arrayMethods;\r\n\r\n      //观测数组中的每一项\r\n      this.observeArray(value); //处理原有数组中的对象  Object.freeze()冻结  冻结就不能被重写get和set了\r\n    } else {\r\n      this.walk(value);\r\n    }\r\n  }\r\n  //监测数组变化\r\n  observeArray(value) {\r\n    //拿到数组每一项\r\n    for (let i = 0; i < value.length; i++) {//如果数组中是对象的话  就会去递归观测  观测对的时候会增加__ob__属性\r\n      observe(value[i]);\r\n    }\r\n  }\r\n  //监测对象变化，类方便拓展 可直接在下面写方法 无需拆分 还是一个整体\r\n  walk(data) {\r\n    //将对象中所有的key 重新用defineProperty定义成响应式数据\r\n    Object.keys(data).forEach((key) => {\r\n      defineReactive(data, key, data[key]);\r\n    });\r\n  }\r\n}\r\nfunction dependArray(value) {//该方法就是让里层数组收集外层数组的依赖，这样修改里层数也可以更新视图\r\n  for (let i = 0; i < value.length; i++){\r\n    let current = value[i];\r\n    current.__obj__ && current.__obj__.dep.depend()//让里层的和外层的 收集的都是用一个watcher\r\n    if (Array.isArray(current)) {\r\n      dependArray(current)\r\n    }\r\n  }\r\n}\r\n\r\n export function defineReactive(data, key, value) {\r\n  console.log(value,'444')\r\n  //vue2中数据嵌套不要过深，过深浪费性能\r\n\r\n  //value的值可能是个对象\r\n let childOb= observe(value); //对结果进行递归拦截\r\n  //console.log(childOb.dep)\r\n  //defineProperty是重写了get，set方法，而proxy是设置一个代理  不用改写原对象\r\n  let dep = new Dep//观察者模式  每次都会给属性创建个dep\r\n  Object.defineProperty(data, key, {//需要给每个属性都增加个dep\r\n    get() {\r\n      if (Dep.target) {\r\n        dep.depend();//让这个属性自己的dep记住这个watcher  也会让watcher记住这个dep   一个双向的过程\r\n        //childOb有可能是对象  有可能是数组\r\n        if (childOb) {//如果对数组取值 会将当前的watcher和数组进行关联\r\n          childOb.dep.depend();\r\n          if (Array.isArray(value)) {\r\n            dependArray(value)\r\n          }\r\n        }\r\n      } \r\n      console.log(key)\r\n      return value;\r\n    },\r\n    set(newValue) {\r\n      if (newValue === value) return;\r\n      observe(value); //如果用户设置的是一个对象，就继续将用户设置的对象变为响应式的\r\n      value = newValue;\r\n\r\n      dep.notify()//通知dep中记录的watcher让它去执行\r\n    },\r\n  });\r\n}\r\n\r\nexport function observe(data) {\r\n  //console.log(data, \"----------\");\r\n  //只对对象类型进行观测，非对象类型无法观测\r\n  if (typeof data !== \"object\" || data == null) {\r\n    return;\r\n  }\r\n  if (data.__obj__) {\r\n    //入果有__obj__就说明该属性被观测过了  就直接返回  防止循环引用\r\n    return;\r\n  }\r\n\r\n  //通过类来实现对数据的观测   类可以方便扩展  会产生实例  实例可作为唯一标识\r\n  return new Observer(data);\r\n}\r\n","import { observe } from \"./observer/index.js\";\r\n\r\n\r\n//初始化状态函数中，主要是针对不同情况做不同的初始化。\r\n//例如传入data，传入props，传入methods等等，需要分别初始化。\r\n\r\n\r\n\r\n//vue的数据   data props computed  watch...\r\nexport function initState(vm) {\r\n  //将所有数据都定义在vm属性上，并且后续更改需要触发视图更新\r\n  //拿到用户定义的参数 如data methods等\r\n  const opts = vm.$options; //获取用户属性\r\n\r\n  //   if (opts.props) {\r\n\r\n  //   }\r\n  //   if (opts.methods) {\r\n\r\n  //   }\r\n  //   if (opts.data) {//数据的初始化\r\n\r\n  //   }\r\n  //   if (opts.computed) {\r\n\r\n  //   }\r\n  //   if (opts.watch) {\r\n\r\n  //   }\r\n\r\n  if (opts.data) {\r\n    //数据的初始化\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction proxy(vm, source, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[source][key];\r\n    },\r\n    set(newValue) {\r\n      vm[source][key] = newValue;\r\n    },\r\n  });\r\n}\r\n\r\n//一层套一层  粒度会越来越小\r\nfunction initData(vm) {\r\n  //console.log(vm);\r\n  //进行数据劫持  Object.defineProperty\r\n  //拿到用户传来的数据\r\n  let data = vm.$options.data; //拿到的data有两种情况  一种是对象，一种是函数 根实例可以是对象，可以是函数，组件中data必须是函数\r\n  //对data类型进行判断  如果是函数  获取函数返回值作为对象\r\n  //用call是为了保证date中如果写了this  保证this永远指向当前的实例\r\n  data = vm._data = typeof data === \"function\" ? data.call(vm) : data;\r\n\r\n  //通过vm._data获取劫持后的数据，用户就可以拿到_data\r\n\r\n  //data = vm._data = typeof data === \"functions\" ? data.call(vm) : data;这样很麻烦   所以就需要代理\r\n\r\n  //将_data中的数据全部放到vm上\r\n  for (let key in data) {\r\n    proxy(vm, '_data', key); //如果用户使用  vm.name 等价于 vm._data.name\r\n  }\r\n\r\n  //观测这个数据    Vue响应式的核心方法\r\n  observe(data);\r\n}\r\n","import { compileToFunctions } from \"./compiler/index\";\r\nimport { callHook, mountComponent } from \"./lifecycle\";\r\nimport { initState } from \"./state\";\r\nimport { mergeOptions, nextTick } from \"./until/until\";\r\n\r\nexport function initMixin(Vue) {\r\n\r\n  /*\r\n    Vue是如何渲染的 \r\n    1.Ast\r\n    2.render\r\n    3.vnode\r\n  \r\n  */\r\n\r\n\r\n  Vue.prototype._init = function (options) {\r\n    //console.log(options);\r\n    const vm = this;\r\n   // vm.$options = options; //在实例上有个属性$options 表示的是用户传入的所有属性\r\n    vm.$options = mergeOptions(vm.constructor.options, options)\r\n    console.log(vm.$options)\r\n\r\n    callHook(vm,'beforeCreate')\r\n    //初始化状态   可能初始化很多东西 逻辑很多  一个功能写一个方法\r\n    initState(vm);\r\n\r\n    if (vm.$options.el) {\r\n      //说明数据可以挂载到页面上\r\n      vm.$mount(vm.$options.el);\r\n    }\r\n  };\r\n  Vue.prototype.$nextTick =nextTick\r\n  Vue.prototype.$mount = function (el) {\r\n    el = document.querySelector(el);\r\n    const vm = this;\r\n    const options = vm.$options;\r\n    vm.$el = el;//id=\"app\"\r\n    //如果有render直接使用render即可，没有render看有没有template属性，没有template就接着找外部模板\r\n    if (!options.render) {\r\n      let template = options.template;\r\n      if (!template && el) {\r\n        template = el.outerHTML; //火狐不兼容 document.createElement('div').appendChild('app').innerHTML\r\n      }\r\n\r\n      console.log(template);\r\n\r\n      //如何将模板编译成render函数\r\n      const render = compileToFunctions(template); //将模板编译成一个函数\r\n      options.render = render;\r\n    }\r\n\r\n    mountComponent(vm, el) //组件挂载  \r\n\r\n  };\r\n\r\n\r\n  //   Vue.prototype.$mount = function (el){\r\n  //     el =document.querySelector(el);\r\n  //     const vm =this;\r\n  //     const options = vm.$options\r\n  // //如果有render直接使用render即可，没有render看有没有template属性，没有template就接着找外部模板\r\n  //     if(!options.render){\r\n  //       let template = options.template;\r\n  //       if(!template && el){\r\n  //         template = el.outHTML\r\n  //       }\r\n  //       console.log(template)\r\n  //     }\r\n  //   }\r\n}\r\n//vue的数据   data props computed  watch...\r\n// export function initState(vm) {\r\n//   //将所有数据都定义在vm属性上，并且后续更改需要触发视图更新\r\n//   //拿到用户定义的参数 如data methods等\r\n//   const opts = vm.$options; //获取用户属性\r\n\r\n//     if (opts.props) {\r\n\r\n//     }\r\n//     if (opts.methods) {\r\n\r\n//     }\r\n//     if (opts.data) {//数据的初始化\r\n\r\n//     }\r\n//     if (opts.computed) {\r\n\r\n//     }\r\n//     if (opts.watch) {\r\n\r\n//     }\r\n\r\n//   if (opts.data) {//数据的初始化\r\n//     initState(vm);\r\n//   }\r\n// }\r\n\r\n// //一层套一层  粒度会越来越小\r\n// function initData(vm) {\r\n\r\n// }\r\n","import { isObject, isReservedTag } from \"../until/until\";\r\n\r\n//导出 创建元素虚拟节点\r\nexport function createElement(vm, tag, data = {}, ...children) {\r\n\r\n    //需要对标签名做过滤   因为有可能标签名是一个自定义组件\r\n    if (isReservedTag(tag)) {\r\n        return vnode(vm, tag, data, data.key, children, undefined);\r\n    } else {\r\n        //是一个组件标签\r\n        const Ctor = vm.$options.components[tag];//对象或者函数\r\n        return createComponent(vm, tag, data, data.key, children, Ctor)\r\n    }\r\n\r\n}\r\n\r\nfunction createComponent(vm, tag, data, key, children, Ctor) {\r\n    if (isObject(Ctor)) {\r\n        Ctor = vm.$options._base.extend(Ctor)\r\n    }\r\n    //console.log(Ctor)\r\n    //给组件增加生命周期\r\n    data.hook = {\r\n        init(vnode) { \r\n            //调用子组件的构造函数\r\n     vnode.componentInstance=  new vnode.componentOptions.Ctor({})\r\n        }//初始化的钩子\r\n    }\r\n    console.log(vnode(vm, `vue-component-${Ctor.cid}-${tag}`, data, key, undefined, undefined, { Ctor }))\r\n    //组件的虚拟节点 拥有hook和当前组件的componentOptions中存放了组件的构造函数\r\n    return vnode(vm, `vue-component-${Ctor.cid}-${tag}`, data, key, undefined, undefined,{Ctor})\r\n}\r\n\r\n\r\n\r\n//导出创建文本虚拟节点\r\nexport function createTextVnode(vm, text) {\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text);\r\n}\r\n\r\n//vue底层用的是个类 这里用个方法\r\nfunction vnode(vm, tag, data, key, children, text,componentOptions) {\r\n    return {\r\n        vm,\r\n        tag,\r\n        children,\r\n        data,\r\n        key,\r\n        text,\r\n        componentOptions\r\n    }\r\n}\r\n//vnode(虚拟DOM)和AST(抽象树)  vnode 可以随意添加属性  AST是针对语法解析出来的结构不能添加不存在的属性","import { createElement, createTextVnode } from \"./vdom/index\"\r\n\r\nexport function renderMixin(Vue) {\r\n    //创建元素的虚拟节点\r\n    Vue.prototype._c = function (...args) {\r\n        return createElement(this, ...args)//可以多传参数\r\n    }\r\n    //创建文本的虚拟节点\r\n    Vue.prototype._v = function (text) {\r\n        return createTextVnode(this, text)\r\n    }\r\n    //转化成字符串\r\n    Vue.prototype._s = function (val) {\r\n        return val == null ? '' : (typeof val == 'object') ? JSON.stringify(val) : val\r\n    }\r\n\r\n    //调用自定义render方法\r\n    Vue.prototype._render = function () {\r\n        //render\r\n        //console.log('render')\r\n        const vm = this;\r\n        let render = vm.$options.render//获取编译后额render方法\r\n        //调用render方法 产生虚拟节点 让render执行\r\n        //render中有很多自定义的方法  如_c  _v  所以 会报错 \r\n        let vnode = render.call(vm)//_c(xxx，xxx)  调用时会自动将变量进行取值，将实例结果进行渲染\r\n\r\n        return vnode;//虚拟节点\r\n    }\r\n}","//Vue2.0中就是一个构造函数 如果用class(类)的话  \r\n\r\nimport { initGlobalAPI } from \"./global-api/index\";\r\nimport { initMixin } from \"./init\";\r\nimport { lifecycleMixin } from \"./lifecycle\";\r\nimport { renderMixin } from \"./render\";\r\n\r\n// class Vue{\r\n//     a(){}\r\n//     b(){}\r\n//     c(){}\r\n// }\r\n\r\n\r\n//构造函数\r\nfunction Vue(options) {\r\n    //console.log(options)\r\n    this._init(options)//当用户new Vue时就调用init方法进行vue的初始化方法\r\n}\r\n\r\n//Vue初始化  扩展原型方法\r\n// 将initMixin引入，并将Vue传过去，相当于扩展了init方法\r\n//可以拆分逻辑到不同的文件中 更利于代码维护  模块化的概念\r\ninitMixin(Vue);//初始化混合\r\n\r\n// Vue.prototype._init = function (options) {\r\n\r\n// };\r\nlifecycleMixin(Vue);//更新逻辑   扩展_update方法\r\nrenderMixin(Vue);//调用render方法的逻辑 扩展_render方法\r\n\r\n\r\ninitGlobalAPI(Vue)//混入全局的API\r\n\r\n\r\nexport default Vue\r\n\r\n\r\n//库->rollup   项目开发->webpack"],"names":["callbacks","flushCallbacks","i","length","callback","waiting","nextTick","cb","push","Promise","resolve","then","isObject","val","LIFECYCLE_HOOKS","strats","mergeHook","parentVal","childVal","console","log","concat","forEach","hook","components","res","Object","create","key","mergeOptions","parent","child","options","mergeField","hasOwnProperty","makeUP","str","map","split","tagName","tag","isReservedTag","initGlobalAPI","Vue","mixin","options_base","component","id","definition","name","extend","cid","Super","Sub","VueComponent","_init","prototype","constructor","defaultTagRE","genProps","attrs","attr","obj","value","item","JSON","stringify","slice","genChildren","AST","children","gen","join","node","type","generate","text","test","tokens","match","index","lastIndex","exec","trim","code","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","root","currentParent","stack","start","element","end","pop","chars","replace","advance","n","substring","parseStartTag","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunctions","template","render","fn","Function","patch","oldVnode","Vnode","isRealElement","nodeType","oldElm","parentElm","parentNode","el","createElm","insertBefore","nextSibling","removeChild","createComponent","vnode","data","init","vm","document","createElement","updateProperties","appendChild","createTextNode","newProps","styleName","style","className","setAttribute","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","has","queue","flushSchedularQueue","run","pending","queueWatcher","Watcher","exprOrFn","getter","drps","depsId","Set","get","dep","add","deps","addSub","lifecycleMixin","_update","$options","$el","callHook","handlers","handler","call","mountComponent","updateComponent","_render","oldArrayProtoMethods","Array","arrayMethods","methods","args","result","inserted","ob","__ob__","observeArray","notify","Observer","defineProperty","enumerable","configurable","isArray","setPrototypeOf","walk","observe","keys","defineReactive","dependArray","current","__obj__","depend","childOb","set","newValue","initState","opts","initData","proxy","source","_data","initMixin","$mount","$nextTick","querySelector","outerHTML","undefined","Ctor","_base","componentInstance","componentOptions","createTextVnode","renderMixin","_c","_v","_s"],"mappings":"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"}