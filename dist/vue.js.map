{"version":3,"file":"vue.js","sources":["../src/compiler/generate.js","../src/compiler/parse.js","../src/compiler/index.js","../src/vdom/patch.js","../src/observer/dep.js","../src/observer/watcher.js","../src/lifecycle.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/index.js"],"sourcesContent":["const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //{{}}\r\n\r\nfunction genProps(attrs){\r\n    let str=''\r\n    for(let i=0; i<attrs.length; i++){\r\n        let attr =attrs[i] //name value\r\n        if(attr.name==='style'){\r\n            let obj={}\r\n            attr.value.split(';').forEach(item => {\r\n             let [key,value]  = item.split(':');\r\n             obj[key]=value\r\n            });\r\n            attr.value=obj;//{style:{color:blue}}\r\n        }\r\n        str +=`${attr.name}:${JSON.stringify(attr.value)},`//{a:'aaa',a:1,b:2}\r\n    }\r\n    return` {${str.slice(0,-1)}}`\r\n}\r\n\r\n\r\nfunction genChildren(AST){\r\n    const children = AST.children;\r\n    if(children){\r\n        return children.map(child=>gen(child)).join(',')\r\n    }\r\n}\r\n\r\nfunction gen(node){//区分是元素还是文本\r\n    console.log(node)\r\n\r\n    if(node.type==1){\r\n        return generate(node)\r\n    }else{//文本逻辑不能用_c处理\r\n            //1.有{{}}  普通文本   混合文本 {{name}}  aaa {{age}} bbb\r\n        let text=node.text;\r\n        if(defaultTagRE.test(text)){//_v(_s(name)+_v('aa')\r\n            //说明是带有{{}}\r\n            let tokens =[];\r\n            let match;\r\n            let index=0;\r\n            let lastIndex=defaultTagRE.lastIndex =0;\r\n            while (match = defaultTagRE.exec(text)) {//{{name}}  aaa {{age}} bbb\r\n                index=match.index;\r\n                console.log(match)\r\n                if(index > lastIndex){\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex,index)));\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`);\r\n                lastIndex=index + match[0].length;\r\n            }\r\n            if(lastIndex < text.length){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n\r\n            }\r\n            return `_v(${tokens.join('+')})`\r\n\r\n        }else{\r\n            return `_v(${JSON.stringify(text)})`\r\n        }\r\n    }\r\n}\r\n\r\nexport function generate(AST){//转换成render代码\r\n    console.log(AST)\r\n\r\n    let children = genChildren(AST)\r\n\r\n    let code =`_c('${AST.tag}',${\r\n        AST.attrs.length? genProps(AST.attrs):'undefined'\r\n    }${\r\n        children?(',' + children) : ''\r\n    })`\r\n    console.log(code)\r\n\r\n    return code;\r\n    //进行语法转化  将html代码转化js代码  核心 字符串拼接\r\n}\r\n\r\n\r\n/* <div id=\"app\">\r\n    <div style=\"color:blue\">\r\n            <span>{{name}}</span>\r\n    </div>\r\n</div> \r\n变成render函数  reder函数执行后的结果是个虚拟dom\r\n\r\nrender(){ \r\n    return _c('div',{id:'app'}，\r\n    _c(\r\n        'div',\r\n        {style:{color:\"blue\"}},\r\n        _c(\r\n            'span',\r\n            {}\r\n            _s(_v\"name\")\r\n        )\r\n    )\r\n}\r\n\r\n*/","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //匹配类标签名的  里面的\\\\相当于转译 变成一个\\\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //aa:aa\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); //可以匹配到标签名\r\n\r\n//console.log(\"<div:aa>\".match(startTagOpen));\r\n\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //标签结束名字\r\n//console.log(\"</div:xxx>\".match(endTag));\r\n//style=\"xxx\"  style='xxx'  style=xxx\r\nconst attribute =\r\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\n//console.log(`a='2'`.match(attribute));\r\n\r\nconst startTagClose = /^\\s*(\\/?)>/;\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //{{}}\r\n\r\n\r\n  /* <div id=\"app\">\r\n    <div style=\"color:blue ;\">\r\n      <span>{{name}}</span>\r\n    </div>\r\n</div>\r\n  */\r\n\r\n//AST语法树  描述dom结构\r\n// {\r\n//     tag:'div',//根节点\r\n//     type:1, 元素是1  文本是3  约定俗成\r\n//     attrs:[{style:\"color:red\"}]\r\n//     children:[\r\n//         {\r\n//             tag:'span',\r\n//             type:1,\r\n//             attrs:[],//属性\r\n//             children,\r\n//             parent:\r\n//         }\r\n//     ],\r\n//     parent:null\r\n// }\r\n\r\n /* <div id=\"app\">\r\n        <div style=\"color:blue ;\">\r\n             <span>{{name}}</span>\r\n        </div>\r\n    </div>\r\n  */\r\n\r\nexport function parseHTML(html) {\r\n    function createASTElement(tag,attrs){//vue3中支持多个根元素(外层加了个空元素)，vue2中只有一个根节点\r\n        return{\r\n          tag,\r\n          type:1,\r\n          children:[],\r\n          attrs,\r\n          parent:null\r\n        }\r\n      }\r\n      \r\n      let root =null;\r\n      let currentParent;\r\n      let stack=[];\r\n\r\n\r\n  //根据开始标签  结束标签  文本内容  生成一个AST语法树\r\n    function start(tagName,attrs){\r\n      //console.log('start------',tagName)\r\n      let element =createASTElement(tagName,attrs)\r\n      if(!root){//如果没有根  说明就是第一个元素\r\n          root = element\r\n      }\r\n      currentParent = element;//div->span->a   \r\n      stack.push(element)\r\n\r\n    }\r\n\r\n    function end(tagName){\r\n      //console.log('end------',tagName)\r\n      let element=stack.pop()\r\n      currentParent=stack[stack.length-1]\r\n      if(currentParent){\r\n        element.parent=currentParent;\r\n        currentParent.children.push(element)\r\n      }\r\n    }\r\n    function chars(text){\r\n      //console.log('chars------',text)\r\n\r\n      //文本可能为空   源码里会将其变成一个空格   此处是移除所有空格  \r\n      text = text.replace(/\\s/g,'');\r\n      if(text){\r\n        currentParent.children.push({\r\n          type:3,\r\n          text\r\n        })\r\n      }\r\n\r\n    }\r\n\r\n    //截取\r\n    function advance(n){\r\n        html = html.substring(n)\r\n    }\r\n\r\n    function parseStartTag(){\r\n    const start = html.match(startTagOpen)\r\n    if(start){\r\n        let match ={\r\n            tagName:start[1],\r\n            attrs:[],\r\n        }\r\n        advance(start[0].length);//获取元素\r\n       console.log(html,match)\r\n       //查找属性\r\n       let end,attr;\r\n       //不是开头标签结尾 就一直解析\r\n       while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\r\n            console.log(attr)\r\n            advance(attr[0].length)\r\n            match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\r\n       }\r\n       if(end){\r\n        advance(end[0].length);\r\n        return match\r\n       }\r\n    }\r\n    }\r\n  //标签是以<>开头\r\n\r\n  while (html) {\r\n    let textEnd = html.indexOf('<');//判断 如果<的索引是0,就说明是一个元素 \r\n    if(textEnd == 0 ){\r\n       let startTagMatch = parseStartTag();\r\n       if(startTagMatch){//开始标签\r\n        // console.log(startTagMatch)\r\n        // console.log('开始',startTagMatch.tagName)\r\n        start(startTagMatch.tagName,startTagMatch.attrs)\r\n        continue;\r\n       }\r\n\r\n       //结束标签\r\n       let endTagMatch = html.match(endTag)\r\n       if(endTagMatch){\r\n        advance(endTagMatch[0].length)\r\n      //console.log('结尾',endTagMatch[1])\r\n       end(endTagMatch[1])\r\n\r\n        continue;\r\n       }\r\n       \r\n    }\r\n     /* \r\n\r\n        <div style=\"color:blue ;\">\r\n             <span>{{name}}</span>\r\n        </div>\r\n    </div>\r\n  */\r\n    let text;\r\n    if(textEnd > 0){//开始解析文本\r\n      text =html.substring(0,textEnd)\r\n\r\n    }\r\n    if(text){\r\n      advance(text.length);\r\n      //console.log('文本',text)\r\n      chars(text)\r\n\r\n      //console.log(text);\r\n\r\n    }\r\n\r\n  }\r\n  return root;\r\n}\r\n","import { generate } from \"./generate\";\r\nimport { parseHTML } from \"./parse\";\r\n\r\nexport function compileToFunctions(template) {\r\n  //1.先将模板变成AST抽象树  解析模板\r\n  let AST = parseHTML(template); //解析模板  原理是 每解析一块儿  就删掉一块 长度为0时  就意味着都解析完了\r\n  console.log(template);\r\n  // console.log(root);\r\n\r\n  //root  代码生成\r\n\r\n  let code = generate(AST);\r\n\r\n  let render = `with(this){return ${code}}`;\r\n  console.log(render)\r\n  let fn = new Function(render);\r\n  console.log(fn)\r\n  return fn\r\n\r\n\r\n}\r\n","\r\n\r\nexport function patch(oldVnode, Vnode) {\r\n    //oldVnode是一个真实额元素 (首次渲染)\r\n    //console.log(oldVnode, newVnode)\r\n    const isRealElement = oldVnode.nodeType\r\n\r\n    if (isRealElement) {\r\n        //初次渲染\r\n        const oldElm = oldVnode;//拿到 id=\"app\"\r\n        const parentElm = oldElm.parentNode;//拿到父元素 body\r\n\r\n        let el = createElm(Vnode)  //根据虚拟节点 创建出真实节点\r\n        parentElm.insertBefore(el, oldElm.nextSibling)//将创建的节点插到原有的节点的下一个\r\n        parentElm.removeChild(oldElm);\r\n\r\n        return el//vm.$el\r\n    } else {\r\n        //diff算法\r\n    }\r\n}\r\n\r\n\r\n//根据虚拟节点 创建出真实节点\r\nfunction createElm(vnode) {\r\n    let { vm, tag, data, key, children, text } = vnode\r\n    if (typeof tag === 'string') {//也可能是个组件 先不考虑\r\n        vnode.el = document.createElement(tag);//用vue的指令时，可以用过vnode拿到真实的dom  虚拟节点配合真实dom\r\n        //更新dom上的属性\r\n        updateProperties(vnode);\r\n\r\n        //有可能有儿子\r\n        children.forEach(child => {//可能有文本  可能有元素\r\n            //根据子节点 创建元素\r\n            vnode.el.appendChild(createElm(child))//递归创建\r\n\r\n        })\r\n    } else {//文本情况\r\n        vnode.el = document.createTextNode(text)\r\n\r\n    }\r\n\r\n    return vnode.el\r\n}\r\n\r\nfunction updateProperties(vnode) {\r\n    let newProps = vnode.data || {};//属性\r\n    let el = vnode.el//dom元素\r\n\r\n    for (let key in newProps) {\r\n        if (key == 'style') {\r\n            for (let styleName in newProps.style) {\r\n                el.style[styleName] = newProps.style[styleName]\r\n            }\r\n        } else if (key == 'class') {\r\n            el.className = newProps.class\r\n        } else {\r\n            el.setAttribute(key, newProps[key])\r\n\r\n        }\r\n    }\r\n}","//我们可以把当前watcher 放到一个全局变量上\r\nlet id = 0;//为了保持dep的唯一性\r\nclass Dep {\r\n    constructor() {\r\n        this.id = id++;\r\n        this.subs = [];//属性要记住watcher\r\n\r\n    }\r\n    depend() {\r\n        //让watcher记住dep\r\n        //获取watcher\r\n        Dep.target.addDep(this)//这里的this指的是Dep  name=>watcher  \r\n    }\r\n    //让dep记住watcher  \r\n    addSub(watcher) {//存储watcher\r\n        this.subs.push(watcher)\r\n    }\r\n}\r\nDep.target = null;//类的静态属性\r\nexport function pushTarget(watcher) {\r\n    Dep.watcher = watcher\r\n}\r\nexport function popTarget() {\r\n    Dep.target = null;\r\n}\r\n\r\n\r\n\r\nexport default Dep;","import { popTarget, pushTarget } from \"./dep\";\r\n\r\n//每个组件间有多个watcher  所以需要加一个唯一标识  \r\nlet id = 0;\r\nclass Watcher {\r\n    constructor(vm, exprOrFn, cb, options) {\r\n        this.vm = vm;\r\n        this.cb = cb;\r\n        this.options = options;\r\n        this.id = id++\r\n        this.getter = exprOrFn\r\n        this.drps = [];\r\n        this.depsId = new Set();//去重  \r\n\r\n        this.get();//调用传入的函数 调用了render方法  此时会对模板中的数据进行取值\r\n    }\r\n    get() {//这个方法中会对属性进行取值操作\r\n        pushTarget(this)//给Dep.target赋了值 =watcher\r\n        this.getter()//会取值  执行了observer中index.js中的54行 \r\n        popTarget();//Dep.target = null;\r\n    }\r\n    addDep(dep) {\r\n        let id = dep.id;\r\n        if (!this.depsId.has(id)) {//dep是非重复的\r\n            this.depsId.add(id)\r\n            this.deps.push(dep)\r\n            dep.addSub(this)\r\n        }\r\n    }\r\n    //当属性取值时  需要记住这个watcher，稍后变化了  去执行自己记住的watcher即可\r\n    //依赖收集\r\n}\r\nexport default Watcher;","import { patch } from \"./vdom/patch\";\r\nimport Watcher from \"./observer/watcher\"\r\n//渲染成真实DOM的\r\nexport function lifecycleMixin(Vue) {\r\n    Vue.prototype._update = function (vnode) {\r\n        // console.log('update', vnode);\r\n        //将虚拟节点转换成真实dom\r\n        const vm = this;\r\n\r\n        //首次渲染 需要用虚拟节点 来更新真实的dom元素\r\n        //初始化渲染的时候 会创建一个新节点 并且将老节点删掉\r\n        //第一次渲染完毕后 拿到新的节点 下次再次渲染时替换上次渲染的结果\r\n        vm.$options.el = patch(vm.$options.el, vnode);\r\n    }\r\n}\r\n\r\n\r\nexport function mountComponent(vm, el) {\r\n    console.log(vm, el)\r\n\r\n    //Vue渲染机制\r\n    //Vue默认通过watcher来进行渲染的 = 渲染watcher(每一个组件都有一个渲染watcher)\r\n\r\n    let updateComponent = () => {\r\n        //调用runder方法\r\n        vm._update(vm._render());//返回的是虚拟节点   是一个对象 vm._update是将虚拟节点转化为真实节点\r\n    }\r\n    //让实例的某某方法执行  四个参数   后面加true是为了表明 该watcher是一个渲染watcher\r\n    new Watcher(vm, updateComponent, () => { }, true) //这句话就是相当于让 updateComponent 执行 updateComponent();\r\n\r\n\r\n}","//首先  我需要拿到原来数组原型上的方法  天生自带的方法\r\nlet oldArrayProtoMethods = Array.prototype;\r\n\r\n//不能直接改写数组原有方法  不可靠  因为只有在vue data中定义的数组才需要改写\r\n\r\n//创建一个元素  让他指向原型   继承关系\r\nexport let arrayMethods = Object.create(Array.prototype);\r\n\r\n//因为他指向数组原型链 所以 就可以拿到原型链上的方法\r\n//arrayMethods.push===arrayMethods._proto_.push\r\n\r\n//对数组方法进行重写  一般对改变原数组的操作进行重写\r\n\r\nlet methods = [\r\n    \"push\", \r\n    \"pop\", \r\n    \"shift\", \r\n    \"unshift\", \r\n    \"splice\", \r\n    \"reverse\", \r\n    \"sort\"\r\n];\r\n//如果用户调用arrayMethods.push方法，会调取我重写后的 也就是下面这一坨\r\n\r\nmethods.forEach((methods) => {//AOP切片编程   把原有的逻辑 割一刀 插入自己的逻辑\r\n  arrayMethods[methods] = function (...args) {//重写数组方法\r\n        //做些自己的事儿 \r\n    console.log('数组变化')\r\n    let result = oldArrayProtoMethods[methods].call(this,...args);//这里的this指向arrayMethods\r\n    \r\n    \r\n    //有可能用户后增加的数据是对象格式，也需要进项拦截\r\n    //做个判断  只对数组增加的方法进行判断\r\n    let inserted;\r\n    let ob=this.__ob__;\r\n    switch (methods) {\r\n        case 'push':\r\n        case 'unshift':\r\n            inserted=args;\r\n            break;\r\n            case 'splice'://splice(0,1,xxxx) \r\n            //因为splice方法第三个才是新增的   \r\n            inserted=args.slice(2);\r\n        default:\r\n            break;\r\n    }\r\n\r\n   if(inserted){//如果有值 都需要调observeArray()  这里的this指向调用者 this.__ob__.observeArray(inserted) \r\n    ob.observeArray(inserted)\r\n   }\r\n    return result\r\n  };\r\n});\r\n","import { arrayMethods } from \"./array\";\r\nimport Dep from \"./dep\";\r\n//对数组和对象进行拦截\r\nclass Observer {\r\n  constructor(value) {\r\n    //需要对val属性重新定义\r\n\r\n    //value可能是对象 可能是数组，分类处理    数组不用defineProperty拦截\r\n\r\n    //增加一个自定义属性\r\n    //value.__ob__=this;\r\n    Object.defineProperty(value, \"__ob__\", {\r\n      value: this,\r\n      enumerable: false, //不能被枚举 表示  不能被循环\r\n      configurable: false, //不能删除此属性\r\n    });\r\n\r\n    if (Array.isArray(value)) {\r\n      //数组不用defineProperty拦截  性能不好\r\n      //操作数组方法  push  shift  sort   我需要重写这些方法(一共7个)  增加更新逻辑\r\n      //当是数组时  改写方法为自己重写后的方法\r\n      Object.setPrototypeOf(value, arrayMethods); // 等价于value._proto_ = arrayMethods;\r\n\r\n      //观测数组中的每一项\r\n      this.observeArray(value); //处理原有数组中的对象  Object.freeze()冻结  冻结就不能被重写get和set了\r\n    } else {\r\n      this.walk(value);\r\n    }\r\n  }\r\n  //监测数组变化\r\n  observeArray(value) {\r\n    //拿到数组每一项\r\n    for (let i = 0; i < value.length; i++) {\r\n      observe(value[i]);\r\n    }\r\n  }\r\n  //监测对象变化，类方便拓展 可直接在下面写方法 无需拆分 还是一个整体\r\n  walk(data) {\r\n    //将对象中所有的key 重新用defineProperty定义成响应式数据\r\n    Object.keys(data).forEach((key) => {\r\n      defineReactive(data, key, data[key]);\r\n    });\r\n  }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n  //vue2中数据嵌套不要过深，过深浪费性能\r\n\r\n  //value的值可能是个对象\r\n  observe(value); //对结果进行递归拦截\r\n\r\n  //defineProperty是重写了get，set方法，而proxy是设置一个代理  不用改写原对象\r\n  let dep = new Dep//观察者模式  每次都会给属性创建个dep\r\n  Object.defineProperty(data, key, {//需要给每个属性都增加个dep\r\n    get() {\r\n      if (Dep.target) {\r\n        dep.depend();//让这个属性自己的dep记住这个watcher  也会让watcher记住这个dep   一个双向的过程\r\n      }\r\n      console.log(key)\r\n      return value;\r\n    },\r\n    set(newValue) {\r\n      if (newValue === value) return;\r\n      observe(value); //如果用户设置的是一个对象，就继续将用户设置的对象变为响应式的\r\n      value = newValue;\r\n    },\r\n  });\r\n}\r\n\r\nexport function observe(data) {\r\n  //console.log(data, \"----------\");\r\n  //只对对象类型进行观测，非对象类型无法观测\r\n  if (typeof data !== \"object\" || data == null) {\r\n    return;\r\n  }\r\n  if (data.__obj__) {\r\n    //入果有__obj__就说明该属性被观测过了  就直接返回  防止循环引用\r\n    return;\r\n  }\r\n\r\n  //通过类来实现对数据的观测   类可以方便扩展  会产生实例  实例可作为唯一标识\r\n  return new Observer(data);\r\n}\r\n","import { observe } from \"./observer/index.js\";\r\n\r\n//vue的数据   data props computed  watch...\r\nexport function initState(vm) {\r\n  //将所有数据都定义在vm属性上，并且后续更改需要触发视图更新\r\n  //拿到用户定义的参数 如data methods等\r\n  const opts = vm.$options; //获取用户属性\r\n\r\n  //   if (opts.props) {\r\n\r\n  //   }\r\n  //   if (opts.methods) {\r\n\r\n  //   }\r\n  //   if (opts.data) {//数据的初始化\r\n\r\n  //   }\r\n  //   if (opts.computed) {\r\n\r\n  //   }\r\n  //   if (opts.watch) {\r\n\r\n  //   }\r\n\r\n  if (opts.data) {\r\n    //数据的初始化\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction proxy(vm, source, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[source][key];\r\n    },\r\n    set(newValue) {\r\n      vm[source][key] = newValue;\r\n    },\r\n  });\r\n}\r\n\r\n//一层套一层  粒度会越来越小\r\nfunction initData(vm) {\r\n  //console.log(vm);\r\n  //进行数据劫持  Object.defineProperty\r\n  //拿到用户传来的数据\r\n  let data = vm.$options.data; //拿到的data有两种情况  一种是对象，一种是函数\r\n  //对data类型进行判断  如果是函数  获取函数返回值作为对象\r\n  //用call是为了保证date中如果写了this  保证this永远指向当前的实例\r\n  data = vm._data = typeof data === \"function\" ? data.call(vm) : data;\r\n\r\n  //通过vm._data获取劫持后的数据，用户就可以拿到_data\r\n\r\n  //data = vm._data = typeof data === \"functions\" ? data.call(vm) : data;这样很麻烦   所以就需要代理\r\n\r\n  //将_data中的数据全部放到vm上\r\n  for (let key in data) {\r\n    proxy(vm, '_data', key); //如果用户使用  vm.name 等价于 vm._data.name\r\n  }\r\n\r\n  //观测这个数据    Vue响应式的核心方法\r\n  observe(data);\r\n}\r\n","import { compileToFunctions } from \"./compiler/index\";\r\nimport { mountComponent } from \"./lifecycle\";\r\nimport { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    //console.log(options);\r\n    const vm = this;\r\n    vm.$options = options; //在实例上有个属性$options 表示的是用户传入的所有属性\r\n\r\n    //初始化状态   可能初始化很多东西 逻辑很多  一个功能写一个方法\r\n    initState(vm);\r\n\r\n    if (vm.$options.el) {\r\n      //说明数据可以挂载到页面上\r\n      vm.$mount(vm.$options.el);\r\n    }\r\n  };\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    el = document.querySelector(el);\r\n    const vm = this;\r\n    const options = vm.$options;\r\n    vm.$options.el = el;//id=\"app\"\r\n    //如果有render直接使用render即可，没有render看有没有template属性，没有template就接着找外部模板\r\n    if (!options.render) {\r\n      let template = options.template;\r\n      if (!template && el) {\r\n        template = el.outerHTML; //火狐不兼容 document.createElement('div').appendChild('app').innerHTML\r\n      }\r\n\r\n      console.log(template);\r\n\r\n      //如何将模板编译成render函数\r\n      const render = compileToFunctions(template); //将模板编译成一个函数\r\n      options.render = render;\r\n    }\r\n\r\n    mountComponent(vm, el) //组件挂载  \r\n\r\n  };\r\n\r\n\r\n  //   Vue.prototype.$mount = function (el){\r\n  //     el =document.querySelector(el);\r\n  //     const vm =this;\r\n  //     const options = vm.$options\r\n  // //如果有render直接使用render即可，没有render看有没有template属性，没有template就接着找外部模板\r\n  //     if(!options.render){\r\n  //       let template = options.template;\r\n  //       if(!template && el){\r\n  //         template = el.outHTML\r\n  //       }\r\n  //       console.log(template)\r\n  //     }\r\n  //   }\r\n}\r\n//vue的数据   data props computed  watch...\r\n// export function initState(vm) {\r\n//   //将所有数据都定义在vm属性上，并且后续更改需要触发视图更新\r\n//   //拿到用户定义的参数 如data methods等\r\n//   const opts = vm.$options; //获取用户属性\r\n\r\n//     if (opts.props) {\r\n\r\n//     }\r\n//     if (opts.methods) {\r\n\r\n//     }\r\n//     if (opts.data) {//数据的初始化\r\n\r\n//     }\r\n//     if (opts.computed) {\r\n\r\n//     }\r\n//     if (opts.watch) {\r\n\r\n//     }\r\n\r\n//   if (opts.data) {//数据的初始化\r\n//     initState(vm);\r\n//   }\r\n// }\r\n\r\n// //一层套一层  粒度会越来越小\r\n// function initData(vm) {\r\n\r\n// }\r\n","//导出 创建元素虚拟节点\r\nexport function createElement(vm, tag, data = {}, ...children) {\r\n    return vnode(vm, tag, data, data.key, children, undefined);\r\n}\r\n//导出创建文本虚拟节点\r\nexport function createTextVnode(vm, text) {\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text);\r\n}\r\n\r\n//vue底层用的是个类 这里用个方法\r\nfunction vnode(vm, tag, data, key, children, text) {\r\n    return {\r\n        vm,\r\n        tag,\r\n        children,\r\n        data,\r\n        key,\r\n        text,\r\n\r\n    }\r\n}\r\n//vnode(虚拟DOM)和AST(抽象树)  vnode 可以随意添加属性  AST是针对语法解析出来的结构不能添加不存在的属性","import { createElement, createTextVnode } from \"./vdom/index\"\r\n\r\nexport function renderMixin(Vue) {\r\n    //创建元素的虚拟节点\r\n    Vue.prototype._c = function (...args) {\r\n        return createElement(this, ...args)//可以多传参数\r\n    }\r\n    //创建文本的虚拟节点\r\n    Vue.prototype._v = function (text) {\r\n        return createTextVnode(this, text)\r\n    }\r\n    //转化成字符串\r\n    Vue.prototype._s = function (val) {\r\n        return val == null ? '' : (typeof val == 'object') ? JSON.stringify(val) : val\r\n    }\r\n\r\n    //调用自定义render方法\r\n    Vue.prototype._render = function () {\r\n        //render\r\n        //console.log('render')\r\n        const vm = this;\r\n        let render = vm.$options.render//获取编译后额render方法\r\n        //调用render方法 产生虚拟节点 让render执行\r\n        //render中有很多自定义的方法  如_c  _v  所以 会报错 \r\n        let vnode = render.call(vm)//_c(xxx，xxx)  调用时会自动将变量进行取值，将实例结果进行渲染\r\n\r\n        return vnode;//虚拟节点\r\n    }\r\n}","//Vue2.0中就是一个构造函数 如果用class(类)的话  \r\n\r\nimport { initMixin } from \"./init\";\r\nimport { lifecycleMixin } from \"./lifecycle\";\r\nimport { renderMixin } from \"./render\";\r\n\r\n// class Vue{\r\n//     a(){}\r\n//     b(){}\r\n//     c(){}\r\n// }\r\n\r\n\r\n//构造函数\r\nfunction Vue(options) {\r\n    console.log(options)\r\n    this._init(options)//当用户new Vue时就调用init方法进行vue的初始化方法\r\n}\r\n\r\n//Vue初始化  扩展原型方法\r\n//可以拆分逻辑到不同的文件中 更利于代码维护  模块化的概念\r\n\r\ninitMixin(Vue);//初始化混合\r\n\r\n// Vue.prototype._init = function (options) {\r\n\r\n// };\r\nlifecycleMixin(Vue);//更新逻辑   扩展_update方法\r\nrenderMixin(Vue);//调用render方法的逻辑 扩展_render方法\r\n\r\n\r\nexport default Vue\r\n\r\n\r\n//库->rollup   项目开发->webpack"],"names":["defaultTagRE","genProps","attrs","str","i","length","attr","name","obj","value","split","forEach","item","key","JSON","stringify","slice","genChildren","AST","children","map","child","gen","join","node","console","log","type","generate","text","test","tokens","match","index","lastIndex","exec","push","trim","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","parent","root","currentParent","stack","start","tagName","element","end","pop","chars","replace","advance","n","substring","parseStartTag","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunctions","template","render","fn","Function","patch","oldVnode","Vnode","isRealElement","nodeType","oldElm","parentElm","parentNode","el","createElm","insertBefore","nextSibling","removeChild","vnode","vm","data","document","createElement","updateProperties","appendChild","createTextNode","newProps","styleName","style","className","setAttribute","id","Dep","subs","target","addDep","watcher","pushTarget","popTarget","Watcher","exprOrFn","cb","options","getter","drps","depsId","Set","get","dep","has","add","deps","addSub","lifecycleMixin","Vue","prototype","_update","$options","mountComponent","updateComponent","_render","oldArrayProtoMethods","Array","arrayMethods","Object","create","methods","args","result","call","inserted","ob","__ob__","observeArray","Observer","defineProperty","enumerable","configurable","isArray","setPrototypeOf","walk","observe","keys","defineReactive","depend","set","newValue","__obj__","initState","opts","initData","proxy","source","_data","initMixin","_init","$mount","querySelector","outerHTML","undefined","createTextVnode","renderMixin","_c","_v","_s","val"],"mappings":"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"}